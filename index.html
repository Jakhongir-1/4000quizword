<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vocabulary Quest</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      :root {
        --primary: #6c63ff;
        --secondary: #ff6584;
        --accent: #4ecdc4;
        --dark: #2c2c54;
        --light: #f7f7f7;
        --success: #2ecc71;
        --warning: #f39c12;
        --danger: #e74c3c;
      }

      body {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px;
        overflow-x: hidden;
      }

      .container {
        width: 100%;
        max-width: 1000px;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 20px;
        box-shadow: 0 15px 50px rgba(0, 0, 0, 0.2);
        overflow: hidden;
        position: relative;
      }

      /* Header Styles */
      header {
        background: linear-gradient(to right, var(--primary), var(--secondary));
        color: white;
        padding: 25px;
        text-align: center;
        position: relative;
        overflow: hidden;
      }

      header::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" width="100" height="100" opacity="0.1"><path d="M20,20 L80,20 L80,80 L20,80 Z" fill="white" stroke="white" stroke-width="2"/></svg>');
        background-size: 50px;
      }

      h1 {
        font-size: 2.8rem;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        position: relative;
      }

      .subtitle {
        font-size: 1.2rem;
        opacity: 0.9;
        position: relative;
      }

      /* Stats Bar */
      .stats-bar {
        display: flex;
        justify-content: space-between;
        padding: 15px 25px;
        background: var(--dark);
        color: white;
        font-weight: 600;
      }

      .stat-item {
        display: flex;
        align-items: center;
        gap: 8px;
      }

      /* Progress Bar */
      .progress-container {
        height: 12px;
        background: #e0e0e0;
        border-radius: 10px;
        margin: 0 25px 25px;
        overflow: hidden;
        box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .progress-bar {
        height: 100%;
        background: linear-gradient(to right, var(--accent), var(--primary));
        border-radius: 10px;
        width: 0%;
        transition: width 0.5s ease;
        position: relative;
        overflow: hidden;
      }

      .progress-bar::after {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.4),
          transparent
        );
        animation: shimmer 2s infinite;
      }

      @keyframes shimmer {
        0% {
          transform: translateX(-100%);
        }
        100% {
          transform: translateX(100%);
        }
      }

      /* Quiz Container */
      .quiz-container {
        padding: 30px;
        display: block;
      }

      .question-container {
        background: white;
        border-radius: 15px;
        padding: 25px;
        margin-bottom: 25px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        border-left: 5px solid var(--primary);
        animation: fadeIn 0.5s ease;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .question-number {
        font-size: 1rem;
        color: var(--dark);
        margin-bottom: 10px;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .question {
        font-size: 1.6rem;
        font-weight: 700;
        color: var(--dark);
        margin-bottom: 5px;
      }

      .hint {
        font-size: 1rem;
        color: var(--primary);
        margin-bottom: 20px;
        font-style: italic;
      }

      .options-container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        margin-bottom: 30px;
      }

      @media (max-width: 768px) {
        .options-container {
          grid-template-columns: 1fr;
        }
      }

      .option {
        background: white;
        border: 2px solid #e0e0e0;
        border-radius: 12px;
        padding: 18px 20px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 1.1rem;
        font-weight: 500;
        display: flex;
        align-items: center;
        gap: 12px;
        position: relative;
        overflow: hidden;
      }

      .option:hover {
        transform: translateY(-3px);
        box-shadow: 0 7px 15px rgba(0, 0, 0, 0.1);
        border-color: var(--primary);
      }

      .option.selected {
        background: rgba(108, 99, 255, 0.1);
        border-color: var(--primary);
        color: var(--primary);
      }

      .option.correct {
        background: rgba(46, 204, 113, 0.15);
        border-color: var(--success);
        color: var(--success);
      }

      .option.incorrect {
        background: rgba(231, 76, 60, 0.15);
        border-color: var(--danger);
        color: var(--danger);
      }

      .option-icon {
        font-size: 1.2rem;
        width: 24px;
        text-align: center;
      }

      .navigation {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      button {
        background: linear-gradient(to right, var(--primary), var(--secondary));
        color: white;
        border: none;
        border-radius: 50px;
        padding: 14px 30px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 5px 15px rgba(108, 99, 255, 0.4);
        display: flex;
        align-items: center;
        gap: 8px;
      }

      button:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(108, 99, 255, 0.6);
      }

      button:active {
        transform: translateY(-1px);
      }

      button:disabled {
        background: #cccccc;
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
      }

      .btn-outline {
        background: white;
        color: var(--primary);
        border: 2px solid var(--primary);
      }

      .btn-outline:hover {
        background: var(--primary);
        color: white;
      }

      /* Score Container */
      .score-container {
        padding: 40px;
        text-align: center;
        display: none;
      }

      .score-card {
        background: white;
        border-radius: 20px;
        padding: 40px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        max-width: 600px;
        margin: 0 auto;
        position: relative;
        overflow: hidden;
      }

      .score-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 8px;
        background: linear-gradient(to right, var(--primary), var(--secondary));
      }

      .trophy {
        font-size: 4rem;
        color: var(--warning);
        margin-bottom: 20px;
        animation: bounce 2s infinite;
      }

      @keyframes bounce {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-10px);
        }
      }

      .score-title {
        font-size: 2.2rem;
        color: var(--dark);
        margin-bottom: 10px;
      }

      .score-value {
        font-size: 4.5rem;
        font-weight: 800;
        background: linear-gradient(to right, var(--primary), var(--secondary));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        margin-bottom: 20px;
      }

      .score-message {
        font-size: 1.3rem;
        color: #666;
        margin-bottom: 30px;
        line-height: 1.6;
      }

      .results-container {
        margin-top: 30px;
        text-align: left;
        max-height: 300px;
        overflow-y: auto;
        padding: 15px;
        border: 1px solid #e0e0e0;
        border-radius: 12px;
      }

      .result-item {
        padding: 12px;
        border-bottom: 1px solid #f0f0f0;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .result-item:last-child {
        border-bottom: none;
      }

      .result-icon {
        font-size: 1.2rem;
        width: 24px;
      }

      .result-correct .result-icon {
        color: var(--success);
      }

      .result-incorrect .result-icon {
        color: var(--danger);
      }

      .result-text {
        flex: 1;
      }

      /* Celebration Effects */
      .confetti {
        position: absolute;
        width: 10px;
        height: 10px;
        background: var(--primary);
        border-radius: 50%;
        animation: confetti-fall 5s linear forwards;
      }

      @keyframes confetti-fall {
        0% {
          transform: translateY(-100px) rotate(0deg);
          opacity: 1;
        }
        100% {
          transform: translateY(1000px) rotate(360deg);
          opacity: 0;
        }
      }

      /* Floating Animations */
      .floating {
        animation: floating 3s ease-in-out infinite;
      }

      @keyframes floating {
        0% {
          transform: translateY(0px);
        }
        50% {
          transform: translateY(-10px);
        }
        100% {
          transform: translateY(0px);
        }
      }

      /* Difficulty Indicator */
      .difficulty {
        display: inline-block;
        padding: 5px 12px;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 600;
        margin-left: 10px;
      }

      .difficulty.easy {
        background: rgba(46, 204, 113, 0.2);
        color: var(--success);
      }

      .difficulty.medium {
        background: rgba(243, 156, 18, 0.2);
        color: var(--warning);
      }

      .difficulty.hard {
        background: rgba(231, 76, 60, 0.2);
        color: var(--danger);
      }

      /* Streak Counter */
      .streak {
        display: flex;
        align-items: center;
        gap: 5px;
        background: rgba(255, 101, 132, 0.1);
        padding: 5px 10px;
        border-radius: 20px;
        color: var(--secondary);
        font-weight: 600;
      }

      /* Timer */
      .timer {
        display: flex;
        align-items: center;
        gap: 5px;
        background: rgba(78, 205, 196, 0.1);
        padding: 5px 10px;
        border-radius: 20px;
        color: var(--accent);
        font-weight: 600;
      }

      /* Level Progress */
      .level-progress {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 20px;
      }

      .level {
        font-weight: 700;
        color: var(--primary);
        font-size: 1.2rem;
      }

      /* Achievement Badges */
      .badges {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin: 20px 0;
      }

      .badge {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background: var(--light);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
      }

      .badge.unlocked {
        background: linear-gradient(to right, var(--primary), var(--secondary));
        color: white;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <h1><i class="fas fa-language"></i> Vocabulary Quest</h1>
        <div class="subtitle">
          Master English-Uzbek vocabulary through interactive challenges!
        </div>
      </header>

      <div class="stats-bar">
        <div class="stat-item">
          <i class="fas fa-fire"></i>
          <span>Streak: <span id="streakCount">0</span></span>
        </div>
        <div class="stat-item">
          <i class="fas fa-trophy"></i>
          <span>Level: <span id="levelCount">1</span></span>
        </div>
        <div class="stat-item">
          <i class="fas fa-star"></i>
          <span>Points: <span id="pointsCount">0</span></span>
        </div>
        <div class="stat-item timer">
          <i class="fas fa-clock"></i>
          <span id="timer">01:00</span>
        </div>
      </div>

      <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
      </div>

      <div class="quiz-container" id="quizContainer">
        <div class="level-progress">
          <div class="level">Level <span id="currentLevel">1</span></div>
          <div class="progress-container" style="flex: 1; margin: 0">
            <div
              class="progress-bar"
              id="levelProgressBar"
              style="width: 0%"
            ></div>
          </div>
        </div>

        <div class="question-container">
          <div class="question-number">
            <i class="fas fa-question-circle"></i>
            Question <span id="questionNumber">1</span> of
            <span id="totalQuestions">10</span>
            <span class="difficulty easy" id="difficulty">Easy</span>
          </div>
          <div class="question" id="question">
            What is the meaning of 'agree'?
          </div>
          <div class="hint" id="hint">
            Hint: This word is about having the same opinion
          </div>
        </div>

        <div class="options-container" id="optionsContainer">
          <!-- Options will be generated here -->
        </div>

        <div class="navigation">
          <button id="hintBtn" class="btn-outline">
            <i class="fas fa-lightbulb"></i> Show Hint
          </button>
          <div>
            <button id="prevBtn" disabled>
              <i class="fas fa-arrow-left"></i> Previous
            </button>
            <button id="nextBtn">
              Next <i class="fas fa-arrow-right"></i>
            </button>
          </div>
        </div>
      </div>

      <div class="score-container" id="scoreContainer">
        <div class="score-card">
          <div class="trophy">
            <i class="fas fa-trophy"></i>
          </div>
          <div class="score-title">Quiz Completed!</div>
          <div class="score-value" id="scoreValue">0/10</div>
          <div class="score-message" id="scoreMessage">
            Keep practicing to improve your vocabulary!
          </div>

          <div class="badges">
            <div class="badge" id="badge1"><i class="fas fa-medal"></i></div>
            <div class="badge" id="badge2"><i class="fas fa-star"></i></div>
            <div class="badge" id="badge3"><i class="fas fa-crown"></i></div>
          </div>

          <button id="restartBtn">
            <i class="fas fa-redo"></i> Play Again
          </button>

          <div class="results-container" id="resultsContainer">
            <!-- Results will be displayed here -->
          </div>
        </div>
      </div>
    </div>

    <script>
      // Enhanced vocabulary data with difficulty levels and hints
      const vocabulary = [
        {
          english: "afraid",
          uzbek: "qo'rqqan, cho'chigan",
          difficulty: "easy",
          hint: "Feeling scared or frightened",
        },
        {
          english: "agree",
          uzbek: "fikriga qo'shilmoq",
          difficulty: "easy",
          hint: "To have the same opinion",
        },
        {
          english: "angry",
          uzbek: "jahli chiqqan",
          difficulty: "easy",
          hint: "Strong feeling of annoyance",
        },
        {
          english: "arrive",
          uzbek: "yetib kelmoq",
          difficulty: "easy",
          hint: "To reach a destination",
        },
        {
          english: "attack",
          uzbek: "hujum qilmoq",
          difficulty: "medium",
          hint: "To act against someone aggressively",
        },
        {
          english: "bottom",
          uzbek: "tagi, pasti",
          difficulty: "easy",
          hint: "The lowest point or part",
        },
        {
          english: "clever",
          uzbek: "aqilli, ziyrak",
          difficulty: "medium",
          hint: "Quick to understand and learn",
        },
        {
          english: "cruel",
          uzbek: "shafqatsiz",
          difficulty: "medium",
          hint: "Willfully causing pain to others",
        },
        {
          english: "finally",
          uzbek: "ahiyri, vanihoyat",
          difficulty: "easy",
          hint: "After a long time or delay",
        },
        {
          english: "hide",
          uzbek: "yashirinmoq",
          difficulty: "easy",
          hint: "To put or keep out of sight",
        },
        {
          english: "hunt",
          uzbek: "ov qilmoq",
          difficulty: "medium",
          hint: "To chase and kill wild animals",
        },
        {
          english: "lot",
          uzbek: "juda ko'p",
          difficulty: "easy",
          hint: "A large number or amount",
        },
        {
          english: "middle",
          uzbek: "o'rta, markaz",
          difficulty: "easy",
          hint: "The central point or part",
        },
        {
          english: "moment",
          uzbek: "sekund, on",
          difficulty: "easy",
          hint: "A very brief period of time",
        },
        {
          english: "pleased",
          uzbek: "hursand, mamnun",
          difficulty: "medium",
          hint: "Feeling happy or satisfied",
        },
        {
          english: "promise",
          uzbek: "va'da bermoq",
          difficulty: "medium",
          hint: "A declaration to do something",
        },
        {
          english: "reply",
          uzbek: "javob bermoq",
          difficulty: "easy",
          hint: "To say or write in response",
        },
        {
          english: "safe",
          uzbek: "hafsiz, behatar",
          difficulty: "easy",
          hint: "Protected from danger or risk",
        },
        {
          english: "trick",
          uzbek: "hiyla, nayrang",
          difficulty: "hard",
          hint: "A cunning act to deceive someone",
        },
        {
          english: "well",
          uzbek: "yaxshi",
          difficulty: "easy",
          hint: "In a good or satisfactory way",
        },
        {
          english: "adventure",
          uzbek: "sarguzasht",
          difficulty: "medium",
          hint: "An exciting or unusual experience",
        },
        {
          english: "approach",
          uzbek: "yaqin kelmoq",
          difficulty: "medium",
          hint: "To come near to something",
        },
        {
          english: "carefully",
          uzbek: "e'tibor bilan",
          difficulty: "easy",
          hint: "In a way that avoids harm",
        },
        {
          english: "chemical",
          uzbek: "kimyoviy modda",
          difficulty: "hard",
          hint: "A substance with a distinct molecular composition",
        },
        {
          english: "create",
          uzbek: "yaratmoq, yasamoq",
          difficulty: "medium",
          hint: "To bring something into existence",
        },
        {
          english: "evil",
          uzbek: "yomon, yovuz",
          difficulty: "medium",
          hint: "Profoundly immoral and wicked",
        },
        {
          english: "experiment",
          uzbek: "tajriba, sinov",
          difficulty: "hard",
          hint: "A scientific procedure to make a discovery",
        },
        {
          english: "kill",
          uzbek: "o'ldirmoq",
          difficulty: "medium",
          hint: "To cause the death of a living being",
        },
        {
          english: "laboratory",
          uzbek: "labaratoriya",
          difficulty: "hard",
          hint: "A room for scientific experiments",
        },
        {
          english: "laugh",
          uzbek: "kulgi",
          difficulty: "easy",
          hint: "The sound of amusement",
        },
      ];

      // Quiz state
      let currentQuestionIndex = 0;
      let score = 0;
      let userAnswers = [];
      let questions = [];
      let streak = 0;
      let points = 0;
      let level = 1;
      let levelProgress = 0;
      let timeLeft = 60;
      let timerInterval;
      let hintsUsed = 0;

      // DOM elements
      const quizContainer = document.getElementById("quizContainer");
      const scoreContainer = document.getElementById("scoreContainer");
      const questionNumber = document.getElementById("questionNumber");
      const totalQuestions = document.getElementById("totalQuestions");
      const questionElement = document.getElementById("question");
      const hintElement = document.getElementById("hint");
      const optionsContainer = document.getElementById("optionsContainer");
      const prevBtn = document.getElementById("prevBtn");
      const nextBtn = document.getElementById("nextBtn");
      const scoreValue = document.getElementById("scoreValue");
      const scoreMessage = document.getElementById("scoreMessage");
      const resultsContainer = document.getElementById("resultsContainer");
      const restartBtn = document.getElementById("restartBtn");
      const progressBar = document.getElementById("progressBar");
      const levelProgressBar = document.getElementById("levelProgressBar");
      const currentLevel = document.getElementById("currentLevel");
      const streakCount = document.getElementById("streakCount");
      const levelCount = document.getElementById("levelCount");
      const pointsCount = document.getElementById("pointsCount");
      const timer = document.getElementById("timer");
      const hintBtn = document.getElementById("hintBtn");
      const difficultyElement = document.getElementById("difficulty");
      const badge1 = document.getElementById("badge1");
      const badge2 = document.getElementById("badge2");
      const badge3 = document.getElementById("badge3");

      // Initialize the quiz
      function initQuiz() {
        // Reset state
        currentQuestionIndex = 0;
        score = 0;
        userAnswers = [];
        streak = 0;
        points = 0;
        level = 1;
        levelProgress = 0;
        timeLeft = 60;
        hintsUsed = 0;

        // Update UI
        updateStats();
        updateTimerDisplay();

        // Generate questions
        questions = generateQuestions(10);

        // Display first question
        displayQuestion();

        // Show quiz container, hide score container
        quizContainer.style.display = "block";
        scoreContainer.style.display = "none";

        // Start timer
        startTimer();

        // Update progress bars
        updateProgressBar();
        updateLevelProgressBar();
      }

      // Start the timer
      function startTimer() {
        clearInterval(timerInterval);
        timerInterval = setInterval(() => {
          timeLeft--;
          updateTimerDisplay();

          if (timeLeft <= 0) {
            clearInterval(timerInterval);
            finishQuiz();
          }
        }, 1000);
      }

      // Update timer display
      function updateTimerDisplay() {
        const minutes = Math.floor(timeLeft / 60);
        const seconds = timeLeft % 60;
        timer.textContent = `${minutes.toString().padStart(2, "0")}:${seconds
          .toString()
          .padStart(2, "0")}`;

        // Change color when time is running out
        if (timeLeft <= 10) {
          timer.style.color = "var(--danger)";
        } else if (timeLeft <= 30) {
          timer.style.color = "var(--warning)";
        } else {
          timer.style.color = "var(--accent)";
        }
      }

      // Update stats display
      function updateStats() {
        streakCount.textContent = streak;
        levelCount.textContent = level;
        pointsCount.textContent = points;
        currentLevel.textContent = level;
      }

      // Generate random questions
      function generateQuestions(numQuestions) {
        const selectedWords = [];
        const questions = [];

        // Select random words
        while (selectedWords.length < numQuestions) {
          const randomIndex = Math.floor(Math.random() * vocabulary.length);
          const word = vocabulary[randomIndex];

          if (!selectedWords.includes(word)) {
            selectedWords.push(word);
          }
        }

        // Create questions
        for (let i = 0; i < selectedWords.length; i++) {
          const correctWord = selectedWords[i];

          // Generate incorrect options
          const incorrectOptions = [];
          while (incorrectOptions.length < 3) {
            const randomIndex = Math.floor(Math.random() * vocabulary.length);
            const randomWord = vocabulary[randomIndex];

            if (
              randomWord !== correctWord &&
              !incorrectOptions.includes(randomWord.uzbek)
            ) {
              incorrectOptions.push(randomWord.uzbek);
            }
          }

          // Combine options and shuffle
          const options = [correctWord.uzbek, ...incorrectOptions];
          shuffleArray(options);

          questions.push({
            question: `What is the Uzbek meaning of '${correctWord.english}'?`,
            options: options,
            correctAnswer: correctWord.uzbek,
            userAnswer: null,
            difficulty: correctWord.difficulty,
            hint: correctWord.hint,
            hintUsed: false,
          });
        }

        return questions;
      }

      // Display current question
      function displayQuestion() {
        const currentQuestion = questions[currentQuestionIndex];

        // Update question number and text
        questionNumber.textContent = currentQuestionIndex + 1;
        totalQuestions.textContent = questions.length;
        questionElement.textContent = currentQuestion.question;

        // Update difficulty
        difficultyElement.textContent =
          currentQuestion.difficulty.charAt(0).toUpperCase() +
          currentQuestion.difficulty.slice(1);
        difficultyElement.className = `difficulty ${currentQuestion.difficulty}`;

        // Reset hint
        hintElement.style.display = "none";
        hintBtn.disabled = false;

        // Clear previous options
        optionsContainer.innerHTML = "";

        // Create option elements
        currentQuestion.options.forEach((option) => {
          const optionElement = document.createElement("div");
          optionElement.className = "option";
          if (currentQuestion.userAnswer === option) {
            optionElement.classList.add("selected");
          }

          const optionIcon = document.createElement("div");
          optionIcon.className = "option-icon";
          optionIcon.innerHTML = '<i class="far fa-circle"></i>';

          const optionText = document.createElement("div");
          optionText.className = "option-text";
          optionText.textContent = option;

          optionElement.appendChild(optionIcon);
          optionElement.appendChild(optionText);
          optionElement.addEventListener("click", () =>
            selectOption(option, optionElement)
          );
          optionsContainer.appendChild(optionElement);
        });

        // Update navigation buttons
        prevBtn.disabled = currentQuestionIndex === 0;

        if (currentQuestionIndex === questions.length - 1) {
          nextBtn.textContent = "Finish";
          nextBtn.innerHTML = 'Finish <i class="fas fa-flag-checkered"></i>';
        } else {
          nextBtn.textContent = "Next";
          nextBtn.innerHTML = 'Next <i class="fas fa-arrow-right"></i>';
        }

        // Update progress bar
        updateProgressBar();
      }

      // Select an option
      function selectOption(option, optionElement) {
        // Remove selected class from all options
        document.querySelectorAll(".option").forEach((opt) => {
          opt.classList.remove("selected");
        });

        // Add selected class to clicked option
        optionElement.classList.add("selected");

        // Update option icon
        const icon = optionElement.querySelector(".option-icon i");
        icon.className = "fas fa-check-circle";

        // Save user's answer
        questions[currentQuestionIndex].userAnswer = option;
        userAnswers[currentQuestionIndex] = option;

        // Automatically proceed to next question after a short delay
        setTimeout(() => {
          if (currentQuestionIndex < questions.length - 1) {
            nextQuestion();
          } else {
            // Last question - finish quiz
            finishQuiz();
          }
        }, 800);
      }

      // Show hint for current question
      function showHint() {
        const currentQuestion = questions[currentQuestionIndex];
        hintElement.textContent = `Hint: ${currentQuestion.hint}`;
        hintElement.style.display = "block";
        hintBtn.disabled = true;
        currentQuestion.hintUsed = true;
        hintsUsed++;

        // Deduct points for using hint
        points = Math.max(0, points - 5);
        updateStats();
      }

      // Update progress bar
      function updateProgressBar() {
        const progress = ((currentQuestionIndex + 1) / questions.length) * 100;
        progressBar.style.width = `${progress}%`;
      }

      // Update level progress bar
      function updateLevelProgressBar() {
        levelProgressBar.style.width = `${levelProgress}%`;
      }

      // Navigate to next question
      function nextQuestion() {
        if (currentQuestionIndex < questions.length - 1) {
          currentQuestionIndex++;
          displayQuestion();
        } else {
          // Last question - finish quiz
          finishQuiz();
        }
      }

      // Navigate to previous question
      function prevQuestion() {
        if (currentQuestionIndex > 0) {
          currentQuestionIndex--;
          displayQuestion();
        }
      }

      // Finish quiz and show results
      function finishQuiz() {
        clearInterval(timerInterval);

        // Calculate score and update stats
        score = 0;
        streak = 0;
        let currentStreak = 0;

        questions.forEach((question) => {
          if (question.userAnswer === question.correctAnswer) {
            score++;
            currentStreak++;

            // Update streak if current streak is higher
            if (currentStreak > streak) {
              streak = currentStreak;
            }

            // Add points based on difficulty
            let pointsEarned = 10;
            if (question.difficulty === "medium") pointsEarned = 15;
            if (question.difficulty === "hard") pointsEarned = 20;

            // Deduct points if hint was used
            if (question.hintUsed) {
              pointsEarned = Math.max(5, pointsEarned - 10);
            }

            points += pointsEarned;
          } else {
            currentStreak = 0;
          }
        });

        // Calculate level progress
        levelProgress = (score / questions.length) * 100;

        // Level up if progress is high enough
        if (levelProgress >= 80 && level < 5) {
          level++;
          levelProgress = 0;
        }

        // Update stats
        updateStats();
        updateLevelProgressBar();

        // Display score
        scoreValue.textContent = `${score}/${questions.length}`;

        // Set score message
        let message = "";
        if (score === questions.length) {
          message = "Perfect! You're a vocabulary master! ðŸŽ‰";
          createConfetti();
          badge1.classList.add("unlocked");
          badge2.classList.add("unlocked");
          badge3.classList.add("unlocked");
        } else if (score >= questions.length * 0.8) {
          message = "Excellent! You know most of these words!";
          badge1.classList.add("unlocked");
          badge2.classList.add("unlocked");
        } else if (score >= questions.length * 0.6) {
          message = "Good job! You're making great progress.";
          badge1.classList.add("unlocked");
        } else if (score >= questions.length * 0.4) {
          message = "Not bad! Keep practicing to improve.";
        } else {
          message = "Keep studying! You'll get better with practice.";
        }

        // Add time bonus if applicable
        if (timeLeft > 0) {
          const timeBonus = Math.floor(timeLeft / 2);
          points += timeBonus;
          message += ` Time bonus: +${timeBonus} points!`;
        }

        scoreMessage.textContent = message;

        // Display detailed results
        resultsContainer.innerHTML = "";
        questions.forEach((question, index) => {
          const resultItem = document.createElement("div");
          resultItem.className = "result-item";

          const isCorrect = question.userAnswer === question.correctAnswer;
          if (isCorrect) {
            resultItem.classList.add("result-correct");
          } else {
            resultItem.classList.add("result-incorrect");
          }

          const resultIcon = document.createElement("div");
          resultIcon.className = "result-icon";
          resultIcon.innerHTML = isCorrect
            ? '<i class="fas fa-check-circle"></i>'
            : '<i class="fas fa-times-circle"></i>';

          const resultText = document.createElement("div");
          resultText.className = "result-text";
          resultText.innerHTML = `
                    <strong>Q${index + 1}: ${question.question}</strong><br>
                    Your answer: ${question.userAnswer || "Not answered"}<br>
                    Correct answer: ${question.correctAnswer}
                    ${question.hintUsed ? "<br><small>Hint used</small>" : ""}
                `;

          resultItem.appendChild(resultIcon);
          resultItem.appendChild(resultText);
          resultsContainer.appendChild(resultItem);
        });

        // Show score container, hide quiz container
        quizContainer.style.display = "none";
        scoreContainer.style.display = "block";
      }

      // Create confetti effect
      function createConfetti() {
        const colors = ["#6C63FF", "#FF6584", "#4ECDC4", "#2ECC71", "#F39C12"];
        const container = document.querySelector(".container");

        for (let i = 0; i < 100; i++) {
          const confetti = document.createElement("div");
          confetti.className = "confetti";
          confetti.style.left = Math.random() * 100 + "vw";
          confetti.style.background =
            colors[Math.floor(Math.random() * colors.length)];
          confetti.style.width = Math.random() * 10 + 5 + "px";
          confetti.style.height = confetti.style.width;
          confetti.style.animationDuration = Math.random() * 3 + 2 + "s";
          confetti.style.opacity = Math.random() * 0.5 + 0.5;

          container.appendChild(confetti);

          // Remove confetti after animation completes
          setTimeout(() => {
            confetti.remove();
          }, 5000);
        }
      }

      // Utility function to shuffle array
      function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
      }

      // Event listeners
      nextBtn.addEventListener("click", nextQuestion);
      prevBtn.addEventListener("click", prevQuestion);
      restartBtn.addEventListener("click", initQuiz);
      hintBtn.addEventListener("click", showHint);

      // Initialize the quiz when page loads
      window.addEventListener("load", initQuiz);
    </script>
  </body>
</html>
